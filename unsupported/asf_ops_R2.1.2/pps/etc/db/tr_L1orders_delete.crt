/*************************************************************************
 * Copyright(c) 1996, California Institute of Technology.                *
 *             ALL RIGHTS RESERVED.                                      *
 * U.S. Government Sponsorship acknowledged.                             *
 *************************************************************************/
/*=======================
	@(#)tr_L1orders_delete.crt	1.1  11/21/96
=========================*/

if exists (select * from sysobjects where name = "tr_L1orders_delete")
        drop trigger tr_L1orders_delete
go

create trigger tr_L1orders_delete
	on L1_orders
	for delete
as
begin
	declare @num_rows int

	select @num_rows = count(*) from deleted

	if @num_rows = 0
		return

	/* Need this extra trigger for duplicate orders :
	 * when a number of orders map into a single job id
	 * The trigger on Jobs table will delete all Scan
	 * orders and Dub orders.
	 */
	delete ppsgui_orders
		from ppsgui_orders, deleted
		where ppsgui_orders.order_id = deleted.order_id
		and   ppsgui_orders.item_id = deleted.item_id

end
go
