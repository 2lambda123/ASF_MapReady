/*************************************************************************
 * Copyright(c) 1996, California Institute of Technology.                *
 *             ALL RIGHTS RESERVED.                                      *
 * U.S. Government Sponsorship acknowledged.                             *
 *************************************************************************/

/*=======================
        @(#)sp_remove_scan.crt	1.1  11/27/96
=========================*/

if exists (select * from sysobjects where name = "sp_remove_scan")
	drop proc sp_remove_scan
go

create proc sp_remove_scan (@job_id int) 
as
	begin transaction

        /* delete job from scan_orders table */
        delete from scan_orders
                where scan_orders.job_id = @job_id
	if (@@transtate > 0)
        begin
                rollback transaction
                return -1
        end

        /* delete job from jobs table */
        delete from jobs
                where jobs.job_id = @job_id
        if (@@transtate > 0)
        begin
                rollback transaction
                return -1
        end

        /* delete job from schedule table */
	delete from schedule
		where schedule.job_id = @job_id
        if (@@transtate > 0)
        begin
                rollback transaction
                return -1
        end

	commit transaction
	return 1 
go
